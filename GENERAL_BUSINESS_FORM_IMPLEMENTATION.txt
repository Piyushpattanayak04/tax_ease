// Complete General Business Form Implementation
// This needs to replace the _buildGeneralBusinessDetails() method in t1_questionnaire_2_step.dart

  // ========== GENERAL BUSINESS DETAILS ==========
  Widget _buildGeneralBusinessDetails() {
    final generalBusiness = _formData.selfEmployment?.generalBusiness ?? const T1GeneralBusiness();

    return _buildSection(
      title: 'General Business Income & Expenses',
      subtitle: 'Self-employment or freelance business income',
      child: Column(
        children: [
          _buildTextField(
            label: 'Client Name',
            initialValue: generalBusiness.clientName,
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(clientName: value),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Business Name',
            initialValue: generalBusiness.businessName,
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(businessName: value),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          Text(
            'Income',
            style: Theme.of(context).textTheme.titleMedium?.copyWith(
              fontWeight: FontWeight.w600,
            ),
          ),
          const SizedBox(height: 12),
          _buildTextField(
            label: 'Sales, commissions, or fees (including HST)',
            initialValue: generalBusiness.salesCommissionsFees > 0 ? generalBusiness.salesCommissionsFees.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(salesCommissionsFees: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Minus HST collected',
            initialValue: generalBusiness.minusHstCollected > 0 ? generalBusiness.minusHstCollected.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(minusHstCollected: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Gross income',
            initialValue: generalBusiness.grossIncome > 0 ? generalBusiness.grossIncome.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(grossIncome: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          Text(
            'Costs of goods sold',
            style: Theme.of(context).textTheme.titleMedium?.copyWith(
              fontWeight: FontWeight.w600,
            ),
          ),
          const SizedBox(height: 12),
          _buildTextField(
            label: 'Opening inventory',
            initialValue: generalBusiness.openingInventory > 0 ? generalBusiness.openingInventory.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(openingInventory: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Purchases during the year',
            initialValue: generalBusiness.purchasesDuringYear > 0 ? generalBusiness.purchasesDuringYear.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(purchasesDuringYear: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Subcontracts',
            initialValue: generalBusiness.subcontracts > 0 ? generalBusiness.subcontracts.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(subcontracts: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Direct wage costs',
            initialValue: generalBusiness.directWageCosts > 0 ? generalBusiness.directWageCosts.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(directWageCosts: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Other costs',
            initialValue: generalBusiness.otherCosts > 0 ? generalBusiness.otherCosts.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(otherCosts: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Minus: purchase returns',
            initialValue: generalBusiness.purchaseReturns > 0 ? generalBusiness.purchaseReturns.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(purchaseReturns: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          Text(
            'Business Expenses',
            style: Theme.of(context).textTheme.titleMedium?.copyWith(
              fontWeight: FontWeight.w600,
            ),
          ),
          const SizedBox(height: 12),
          _buildTextField(
            label: 'Advertising',
            initialValue: generalBusiness.advertising > 0 ? generalBusiness.advertising.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(advertising: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Meals & entertainment',
            initialValue: generalBusiness.mealsEntertainment > 0 ? generalBusiness.mealsEntertainment.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(mealsEntertainment: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Bad debts',
            initialValue: generalBusiness.badDebts > 0 ? generalBusiness.badDebts.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(badDebts: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Insurance',
            initialValue: generalBusiness.insurance > 0 ? generalBusiness.insurance.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(insurance: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Interest',
            initialValue: generalBusiness.interest > 0 ? generalBusiness.interest.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(interest: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Fees, licenses, dues',
            initialValue: generalBusiness.feesLicensesDues > 0 ? generalBusiness.feesLicensesDues.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(feesLicensesDues: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Office expenses',
            initialValue: generalBusiness.officeExpenses > 0 ? generalBusiness.officeExpenses.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(officeExpenses: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Supplies',
            initialValue: generalBusiness.supplies > 0 ? generalBusiness.supplies.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(supplies: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Legal, accounting, and professional fees',
            initialValue: generalBusiness.legalAccountingFees > 0 ? generalBusiness.legalAccountingFees.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(legalAccountingFees: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Management & administration',
            initialValue: generalBusiness.managementAdministration > 0 ? generalBusiness.managementAdministration.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(managementAdministration: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Office rent',
            initialValue: generalBusiness.officeRent > 0 ? generalBusiness.officeRent.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(officeRent: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Maintenance & repairs',
            initialValue: generalBusiness.maintenanceRepairs > 0 ? generalBusiness.maintenanceRepairs.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(maintenanceRepairs: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Salaries, wages, benefits',
            initialValue: generalBusiness.salariesWagesBenefits > 0 ? generalBusiness.salariesWagesBenefits.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(salariesWagesBenefits: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Property tax',
            initialValue: generalBusiness.propertyTax > 0 ? generalBusiness.propertyTax.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(propertyTax: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Travel',
            initialValue: generalBusiness.travel > 0 ? generalBusiness.travel.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(travel: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Telephone and utilities',
            initialValue: generalBusiness.telephoneUtilities > 0 ? generalBusiness.telephoneUtilities.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(telephoneUtilities: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Fuel costs (non-motor vehicle)',
            initialValue: generalBusiness.fuelCosts > 0 ? generalBusiness.fuelCosts.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(fuelCosts: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Delivery, freight, express',
            initialValue: generalBusiness.deliveryFreightExpress > 0 ? generalBusiness.deliveryFreightExpress.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(deliveryFreightExpress: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Other expense 1',
            initialValue: generalBusiness.otherExpense1 > 0 ? generalBusiness.otherExpense1.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(otherExpense1: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Other expense 2',
            initialValue: generalBusiness.otherExpense2 > 0 ? generalBusiness.otherExpense2.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(otherExpense2: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Other expense 3',
            initialValue: generalBusiness.otherExpense3 > 0 ? generalBusiness.otherExpense3.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(otherExpense3: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          Text(
            'Office-in-house expenses',
            style: Theme.of(context).textTheme.titleMedium?.copyWith(
              fontWeight: FontWeight.w600,
            ),
          ),
          const SizedBox(height: 12),
          _buildTextField(
            label: 'Area of home used for business',
            initialValue: generalBusiness.areaOfHomeForBusiness,
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(areaOfHomeForBusiness: value),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Total area of home',
            initialValue: generalBusiness.totalAreaOfHome,
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(totalAreaOfHome: value),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Heat',
            initialValue: generalBusiness.heat > 0 ? generalBusiness.heat.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(heat: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Electricity',
            initialValue: generalBusiness.electricity > 0 ? generalBusiness.electricity.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(electricity: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Insurance',
            initialValue: generalBusiness.houseInsurance > 0 ? generalBusiness.houseInsurance.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(houseInsurance: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Maintenance & repairs',
            initialValue: generalBusiness.homeMaintenance > 0 ? generalBusiness.homeMaintenance.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(homeMaintenance: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Mortgage interest',
            initialValue: generalBusiness.mortgageInterest > 0 ? generalBusiness.mortgageInterest.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(mortgageInterest: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Property taxes',
            initialValue: generalBusiness.propertyTaxes > 0 ? generalBusiness.propertyTaxes.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(propertyTaxes: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'House rent',
            initialValue: generalBusiness.houseRent > 0 ? generalBusiness.houseRent.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(houseRent: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Other expense 1',
            initialValue: generalBusiness.homeOtherExpense1 > 0 ? generalBusiness.homeOtherExpense1.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(homeOtherExpense1: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Other expense 2',
            initialValue: generalBusiness.homeOtherExpense2 > 0 ? generalBusiness.homeOtherExpense2.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(homeOtherExpense2: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          Text(
            'Motor vehicle expenses',
            style: Theme.of(context).textTheme.titleMedium?.copyWith(
              fontWeight: FontWeight.w600,
            ),
          ),
          const SizedBox(height: 12),
          _buildTextField(
            label: 'Kilometers driven to earn business income',
            initialValue: generalBusiness.kmDrivenForBusiness > 0 ? generalBusiness.kmDrivenForBusiness.toString() : '',
            keyboardType: TextInputType.number,
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(kmDrivenForBusiness: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Total kilometers driven in tax year',
            initialValue: generalBusiness.totalKmDrivenInYear > 0 ? generalBusiness.totalKmDrivenInYear.toString() : '',
            keyboardType: TextInputType.number,
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(totalKmDrivenInYear: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Fuel',
            initialValue: generalBusiness.vehicleFuel > 0 ? generalBusiness.vehicleFuel.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(vehicleFuel: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Insurance',
            initialValue: generalBusiness.vehicleInsurance > 0 ? generalBusiness.vehicleInsurance.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(vehicleInsurance: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'License and registration',
            initialValue: generalBusiness.licenseRegistration > 0 ? generalBusiness.licenseRegistration.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(licenseRegistration: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Maintenance & repairs',
            initialValue: generalBusiness.vehicleMaintenance > 0 ? generalBusiness.vehicleMaintenance.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(vehicleMaintenance: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Business parking',
            initialValue: generalBusiness.businessParking > 0 ? generalBusiness.businessParking.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(businessParking: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Other (specify)',
            initialValue: generalBusiness.vehicleOtherExpense > 0 ? generalBusiness.vehicleOtherExpense.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(vehicleOtherExpense: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
          const SizedBox(height: 16),
          _buildTextField(
            label: 'Leasing or finance payments',
            initialValue: generalBusiness.leasingFinancePayments > 0 ? generalBusiness.leasingFinancePayments.toString() : '',
            keyboardType: TextInputType.number,
            prefix: '\$ ',
            onChanged: (value) {
              _updateFormData(_formData.copyWith(
                selfEmployment: _formData.selfEmployment?.copyWith(
                  generalBusiness: generalBusiness.copyWith(leasingFinancePayments: double.tryParse(value) ?? 0),
                ),
              ));
            },
          ),
        ],
      ),
    );
  }
